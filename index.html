<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ryan ♡ Bryce</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#f5f5f5;font-family:system-ui,-apple-system,sans-serif;color:#000;height:100vh;display:flex;flex-direction:column;overflow:hidden}
header{background:#fff;border-bottom:1px solid #dbdbdb;padding:16px;text-align:center;font-size:1.6em;font-weight:600;position:relative;cursor:pointer;box-shadow:0 1px 3px rgba(0,0,0,.06)}
#messages{flex:1;padding:20px 0;overflow-y:auto;display:flex;flex-direction:column;gap:8px}
.message{max-width:80%;padding:12px 16px;border-radius:22px;line-height:1.4;position:relative;word-wrap:break-word}
.you{background:#0084ff;color:#fff;align-self:flex-end;border-bottom-right-radius:4px}
.them{background:#e0e0e0;color:#000;align-self:flex-start;border-bottom-left-radius:4px}
.time{font-size:0.75em;color:#999;margin-top:6px;text-align:right;padding-right:10px}
#inputArea{background:#fff;border-top:1px solid #dbdbdb;padding:10px;display:flex;align-items:center;gap:10px}
#msg{flex:1;padding:12px 16px;border-radius:30px;background:#f1f1f1;font-size:1.05em;border:none;outline:none}
#send{background:#0095f6;color:#fff;width:46px;height:46px;border-radius:50%;border:none;font-size:1.6em;cursor:pointer;display:flex;align-items:center;justify-content:center}
#profile{position:fixed;inset:0;background:#fff;display:none;flex-direction:column;align-items:center;padding-top:60px;z-index:999;text-align:center}
#profile h1{font-size:2.5em;margin:20px 0}
#profilePhoto{width:120px;height:120px;border-radius:50%;object-fit:cover;margin:20px 0;border:4px solid #dbdbdb}
#profile input{margin:15px 0;padding:12px;width:80%;max-width:300px;border:1px solid #dbdbdb;border-radius:10px;font-size:1.1em}
#profile button{background:#0095f6;color:#fff;padding:14px 40px;border:none;border-radius:8px;font-size:1.2em;cursor:pointer;margin-top:20px}
#close{position:absolute;top:20px;right:20px;font-size:1.8em;color:#999;cursor:pointer}
</style>
</head><body>

<header onclick="openProfile()">Bryce</header>

<div id="messages"></div>

<div id="inputArea">
  <input type="text" id="msg" placeholder="iMessage">
  <button onclick="send()">Send</button>
</div>

<div id="profile">
  <span id="close" onclick="closeProfile()">×</span>
  <h1>Profile</h1>
  <img id="profilePhoto" src="https://via.placeholder.com/120/dbdbdb/000000?text=Photo">
  <input type="text" id="profileName" placeholder="Your name">
  <input type="color" id="bubbleColor" value="#0084ff">
  <input type="file" id="photoUpload" accept="image/*" style="display:none">
  <button onclick="document.getElementById('photoUpload').click()">Change Photo</button>
  <button onclick="saveProfile()">Save</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
// Your Firebase URL
const firebaseConfig = {
  databaseURL: "https://chatroom-3b44c-default-rtdb.firebaseio.com/"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database().ref("messages");

let myName = localStorage.getItem('myName') || prompt("Your name (Ryan or Bryce)?", "Ryan");
localStorage.setItem('myName', myName);

function send(){
  const text = document.getElementById('msg').value.trim();
  if(!text) return;
  db.push({
    name: myName,
    text: text,
    time: new Date().toLocaleTimeString([], {hour:'numeric', minute:'2-digit'})
  });
  document.getElementById('msg').value = '';
}

function addMessage(m){
  const div = document.createElement('div');
  div.className = `message ${m.name === myName ? 'you' : 'them'}`;
  div.innerHTML = `${m.text}<div class="time">${m.time}</div>`;
  document.getElementById('messages').appendChild(div);
  document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;
}

db.on('child_added', snapshot => addMessage(snapshot.val()));

// Profile
function openProfile(){
  document.getElementById('profile').style.display = 'flex';
  document.getElementById('profileName').value = myName;
  document.getElementById('bubbleColor').value = localStorage.getItem('myColor') || '#0084ff';
  document.getElementById('profilePhoto').src = localStorage.getItem('myPhoto') || 'https://via.placeholder.com/120/dbdbdb/000000?text=Photo';
}

function closeProfile(){
  document.getElementById('profile').style.display = 'none';
}

function saveProfile(){
  myName = document.getElementById('profileName').value.trim() || myName;
  localStorage.setItem('myName', myName);
  localStorage.setItem('myColor', document.getElementById('bubbleColor').value);
  closeProfile();
}

// Photo upload
document.getElementById('photoUpload').onchange = e => {
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = ev => {
      document.getElementById('profilePhoto').src = ev.target.result;
      localStorage.setItem('myPhoto', ev.target.result);
    };
    reader.readAsDataURL(file);
  }
};

// Apply custom bubble color
document.querySelectorAll('.you').forEach(b => b.style.background = localStorage.getItem('myColor') || '#0084ff');

// Enter = send
document.getElementById('msg').addEventListener('keypress', e => {
  if(e.key === 'Enter') send();
});
</script>
</body></html>